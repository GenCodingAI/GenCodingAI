<head>
  <!-- Favicon -->
  <link rel="icon" type="image/png" href="favicon.png">

  <!-- Google Sign-In -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <script src="https://cdn.jsdelivr.net/npm/jwt-decode/build/jwt-decode.min.js"></script>

  <script>
    const GOOGLE_CLIENT_ID = "472534217982-r7rmrlueav1r14snjvjl9j7bn7hb8nst.apps.googleusercontent.com";

    function handleCredentialResponse(response) {
      const data = jwt_decode(response.credential);
      console.log("User data:", data);
    }

    window.onload = function () {
      google.accounts.id.initialize({
        client_id: GOOGLE_CLIENT_ID,
        callback: handleCredentialResponse
      });

      google.accounts.id.renderButton(
        document.getElementById("googleSignInDiv"),
        { theme: "outline", size: "large" }
      );

      google.accounts.id.prompt();
    };
  </script>
</head>
<body>
  <div id="googleSignInDiv"></div>
</body>

<style>
/* ===== Reset ===== */
*,
*::before,
*::after {
  box-sizing: border-box;
}

html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  background: linear-gradient(135deg, #001a4d, #000b1a);
  color: #cce6ff;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  user-select: none;
  overflow: hidden;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Scrollbars */
::-webkit-scrollbar {
  width: 12px;
  height: 12px;
}
::-webkit-scrollbar-track {
  background: #00102a;
  border-radius: 8px;
  box-shadow: inset 0 0 5px #0033aa66;
}
::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg, #3399ffcc, #0d4fffcc);
  border-radius: 8px;
  box-shadow: inset 0 0 10px #0055ffaa;
}
::-webkit-scrollbar-thumb:hover {
  background: linear-gradient(180deg, #66b3ff, #3377ff);
}

/* === Root container === */
.page {
  display: grid;
  grid-template-columns: 280px 1fr;
  grid-template-rows: 64px 1fr 44px;
  grid-template-areas:
    "sidebar header"
    "sidebar main"
    "sidebar footer";
  height: 100vh;
  max-width: 1100px;
  margin: 0 auto;
  background: #00102a;
  border-radius: 12px;
  box-shadow:
    0 0 25px #0045ffbb,
    inset 0 0 40px #002a5a;
  overflow: hidden;
  user-select: text;
}

/* === Sidebar === */
.sidebar {
  grid-area: sidebar;
  background: #001840;
  border-right: 1.5px solid #0a48ffaa;
  display: flex;
  flex-direction: column;
  padding: 24px 18px;
  color: #99cfffdd;
  box-shadow: inset -2px 0 18px #0040ff44;
  overflow-y: auto;
}

/* Sidebar header - logo */
.sidebar-header {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 36px;
  user-select: none;
}

.sidebar-header img.logo-img {
  width: 48px;
  height: 48px;
  border-radius: 10px;
  filter:
    drop-shadow(0 0 8px #33aaff88)
    drop-shadow(0 0 15px #55ccffcc);
}

.sidebar-header h1.logo-text {
  font-weight: 900;
  font-size: 2rem;
  color: #33aaff;
  letter-spacing: 2px;
  text-shadow:
    0 0 12px #66b3ff,
    0 0 22px #33aaffbb;
  margin: 0;
  user-select: none;
}

/* Sidebar nav */
.nav-tabs {
  display: flex;
  flex-direction: column;
  gap: 14px;
  margin-bottom: auto;
}

.nav-tab {
  background: #002255bb;
  padding: 14px 22px;
  border-radius: 12px;
  font-weight: 700;
  color: #a1caffcc;
  cursor: pointer;
  text-align: center;
  text-shadow:
    0 0 6px #2a7fffaa;
  box-shadow:
    0 0 15px #0070ff88;
  user-select: none;
  transition:
    background-color 0.35s ease,
    box-shadow 0.4s ease,
    color 0.3s ease;
  border: 2.5px solid transparent;
}

.nav-tab:hover {
  background: #0033ffdd;
  color: #d0e9ff;
  box-shadow:
    0 0 20px #3399ffee,
    0 0 40px #55bbffcc;
}

.nav-tab.active {
  background: #0050ffee;
  color: #effcff;
  border: 2.5px solid #99ccff;
  box-shadow:
    0 0 30px #33aaffff,
    inset 0 0 20px #66b3ffff;
  cursor: default;
  pointer-events: none;
}

/* Sidebar footer */
.sidebar-footer {
  margin-top: 32px;
  font-size: 0.85rem;
  color: #5599ffcc;
  user-select: none;
  text-align: center;
  text-shadow: 0 0 5px #2277ffbb;
}

/* === Header === */
.header {
  grid-area: header;
  display: flex;
  align-items: center;
  justify-content: space-between;
  background: #00184a;
  padding: 0 20px;
  border-bottom: 1.5px solid #2244ffcc;
  box-shadow: 0 2px 20px #0033ffaa inset;
  user-select: none;
  color: #a4caffcc;
}

.header-left {
  display: flex;
  align-items: center;
  gap: 14px;
}

.header-left h2 {
  margin: 0;
  font-weight: 800;
  font-size: 1.6rem;
  color: #33aaff;
  text-shadow:
    0 0 15px #33aaffcc,
    0 0 30px #55bbffdd;
}

.header-right {
  display: flex;
  align-items: center;
  gap: 10px;
}

/* Google Signin container */
#googleSignInDiv {
  min-width: 180px;
}

/* Buttons */
.btn {
  background: transparent;
  border: 2.5px solid #33aaffcc;
  color: #a4d2ffcc;
  font-weight: 600;
  padding: 8px 20px;
  border-radius: 14px;
  cursor: pointer;
  user-select: none;
  transition:
    background-color 0.3s ease,
    color 0.3s ease,
    border-color 0.3s ease,
    box-shadow 0.3s ease;
  box-shadow:
    0 0 12px #33aaff99;
}

.btn:hover {
  background-color: #3399ffdd;
  color: #e1f3ff;
  border-color: #55aaffff;
  box-shadow:
    0 0 20px #66b3ffff,
    0 0 40px #77cfffdd;
}

.btn:active {
  transform: scale(0.96);
}

/* === Main content === */
.main {
  grid-area: main;
  background: #00102a;
  padding: 24px 28px;
  overflow-y: auto;
  user-select: text;
  box-shadow:
    inset 0 0 20px #0044ff66;
  border-radius: 0 0 0 12px;
  display: flex;
  flex-direction: column;
  gap: 24px;
}

/* Hide scrollbar but keep scroll */
.main::-webkit-scrollbar {
  width: 10px;
}

.main::-webkit-scrollbar-thumb {
  background: #2255ffcc;
  border-radius: 8px;
  box-shadow: inset 0 0 12px #0055ffbb;
}

/* === Footer === */
.footer {
  grid-area: footer;
  background: #00182a;
  border-top: 1.5px solid #2244ffcc;
  box-shadow: inset 0 2px 14px #0020aa;
  font-size: 0.85rem;
  color: #5599ffcc;
  display: flex;
  justify-content: center;
  align-items: center;
  user-select: none;
  text-shadow: 0 0 6px #2244ffaa;
  padding: 10px 0;
}

/* === Tabs Content Containers === */
.tab-content {
  display: none;
  height: 100%;
  overflow-y: auto;
  padding-right: 12px;
  user-select: text;
}

.tab-content.active {
  display: block;
}

/* === Chat Tab === */
.chat-container {
  display: flex;
  flex-direction: column;
  height: 100%;
}

.chat-header {
  font-size: 1.4rem;
  font-weight: 700;
  color: #66aaff;
  margin-bottom: 12px;
  user-select: none;
  text-shadow:
    0 0 10px #33aaffcc;
}

.messages {
  flex: 1;
  overflow-y: auto;
  padding: 16px;
  background: #001a3a;
  border-radius: 14px;
  box-shadow:
    inset 0 0 25px #003d99aa;
  scrollbar-width: thin;
  scrollbar-color: #5599ff99 transparent;
  font-size: 1rem;
  line-height: 1.5;
  color: #cce8ffdd;
  user-select: text;
}

.message {
  max-width: 85%;
  margin-bottom: 14px;
  padding: 14px 20px;
  border-radius: 24px;
  box-shadow:
    0 0 12px #2277ffbb;
  line-break: anywhere;
  word-wrap: break-word;
  position: relative;
  animation: fadeInUp 0.5s ease forwards;
  opacity: 0;
  transform: translateY(20px);
  color: #bbddff;
}

.message.bot {
  background: linear-gradient(135deg, #004080, #0060cc);
  margin-left: 0;
  box-shadow:
    0 0 18px #3399ffbb,
    inset 0 0 15px #0077ff99;
  color: #ddf5ff;
}

.message.user {
  background: linear-gradient(135deg, #0050ff, #3388ff);
  margin-left: auto;
  box-shadow:
    0 0 20px #66b3ffcc,
    inset 0 0 15px #0055ffcc;
  color: #e9f2ff;
}

@keyframes fadeInUp {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Chat input container */
.chat-input-container {
  display: flex;
  margin-top: 16px;
  gap: 14px;
}

#chatInput {
  flex-grow: 1;
  font-size: 1.15rem;
  padding: 14px 22px;
  border-radius: 22px;
  border: none;
  outline: none;
  background: #002050;
  color: #bbe6ff;
  box-shadow:
    inset 0 0 15px #0060ffbb;
  transition: box-shadow 0.3s ease;
  user-select: text;
}

#chatInput::placeholder {
  color: #66aaffaa;
  user-select: none;
}

#chatInput:focus {
  box-shadow:
    0 0 24px #3399ffcc,
    inset 0 0 28px #44bbffcc;
}

.btn-send {
  background: linear-gradient(135deg, #3399ff, #1a53cc);
  border-radius: 22px;
  border: none;
  color: #e5f3ff;
  font-weight: 700;
  font-size: 1.1rem;
  padding: 14px 26px;
  cursor: pointer;
  user-select: none;
  box-shadow:
    0 0 20px #3399ffdd,
    0 0 35px #66aaffcc;
  transition:
    background-color 0.3s ease,
    box-shadow 0.3s ease;
}

.btn-send:hover {
  background: linear-gradient(135deg, #66aaff, #3388ff);
  box-shadow:
    0 0 25px #66bbffee,
    0 0 45px #77ccffcc;
}

.btn-send:active {
  transform: scale(0.96);
}

/* === Contact Tab === */
.contact-container {
  color: #bbe6ff;
  max-width: 640px;
  margin: auto;
}

.contact-container h3 {
  font-weight: 700;
  font-size: 1.6rem;
  color: #33aaffcc;
  margin-bottom: 20px;
  user-select: none;
  text-shadow:
    0 0 12px #44bbffcc;
}

.contact-form {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.contact-form label {
  font-weight: 600;
  font-size: 1.05rem;
  color: #5599ffdd;
  user-select: none;
}

.contact-form input,
.contact-form textarea {
  padding: 14px 18px;
  border-radius: 14px;
  border: none;
  outline: none;
  background: #002040dd;
  color: #bbe6ff;
  box-shadow:
    inset 0 0 20px #0044ffaa;
  font-size: 1rem;
  resize: vertical;
  transition: box-shadow 0.3s ease;
}

.contact-form input::placeholder,
.contact-form textarea::placeholder {
  color: #5599ff99;
  user-select: none;
}

.contact-form input:focus,
.contact-form textarea:focus {
  box-shadow:
    0 0 24px #3399ffcc,
    inset 0 0 28px #44bbffcc;
}

.contact-form button {
  align-self: flex-start;
  background: #3388ffcc;
  border-radius: 20px;
  border: none;
  padding: 14px 36px;
  color: #dceeff;
  font-weight: 700;
  font-size: 1.1rem;
  cursor: pointer;
  box-shadow:
    0 0 25px #3388ffcc;
  user-select: none;
  transition: background-color 0.3s ease;
}

.contact-form button:hover {
  background: #44aaffee;
  box-shadow:
    0 0 36px #44aaffee;
}

.contact-form button:active {
  transform: scale(0.96);
}

/* === Premium Tab === */
.premium-container {
  color: #bbe6ff;
  padding: 16px 12px;
  max-width: 720px;
  margin: 0 auto;
  user-select: text;
}

.premium-container h3 {
  font-weight: 900;
  font-size: 2rem;
  color: #3399ffcc;
  text-shadow:
    0 0 15px #66aaffcc,
    0 0 30px #3399ffbb;
  margin-bottom: 28px;
  user-select: none;
  text-align: center;
}

.premium-cards {
  display: flex;
  gap: 22px;
  flex-wrap: wrap;
  justify-content: center;
}

.premium-card {
  background: linear-gradient(135deg, #003366, #0050cc);
  border-radius: 18px;
  box-shadow:
    0 0 30px #004dffcc,
    inset 0 0 15px #0066ffbb;
  color: #d0e9ff;
  width: 260px;
  padding: 24px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  user-select: none;
  transition:
    box-shadow 0.4s ease,
    transform 0.3s ease;
}

.premium-card:hover {
  box-shadow:
    0 0 50px #33aaffee,
    inset 0 0 35px #55bbffff;
  transform: translateY(-10px);
}

.premium-card h4 {
  margin: 0;
  font-weight: 800;
  font-size: 1.4rem;
  color: #99cfffcc;
  text-shadow: 0 0 8px #55bbffcc;
}

.premium-card ul {
  margin: 0;
  padding-left: 20px;
  list-style: disc;
  color: #bbeeffcc;
}

.premium-card ul li {
  margin-bottom: 6px;
  font-weight: 600;
  font-size: 1rem;
}

/* === Settings Tab === */
.settings-container {
  color: #bbe6ff;
  max-width: 600px;
  margin: auto;
  user-select: none;
}

.settings-container h3 {
  font-weight: 900;
  font-size: 2rem;
  color: #33aaffcc;
  margin-bottom: 24px;
  text-shadow:
    0 0 15px #66aaffcc;
}

.settings-group {
  display: flex;
  flex-direction: column;
  gap: 18px;
}

.settings-group label {
  font-weight: 700;
  font-size: 1.1rem;
  display: flex;
  align-items: center;
  gap: 12px;
  cursor: default;
}

.settings-group input[type="checkbox"] {
  width: 20px;
  height: 20px;
  cursor: pointer;
  accent-color: #33aaffcc;
  border-radius: 6px;
  box-shadow: 0 0 6px #33aaffcc inset;
  transition: box-shadow 0.3s ease;
}

.settings-group input[type="checkbox"]:hover {
  box-shadow: 0 0 12px #55bbffcc inset;
}

.settings-group input[type="checkbox"]:checked {
  box-shadow: 0 0 24px #33aaffcc inset;
}

/* Buttons container */
.settings-buttons {
  margin-top: 32px;
  display: flex;
  gap: 16px;
  justify-content: center;
}

.settings-buttons button {
  background: #3388ffcc;
  border-radius: 20px;
  border: none;
  padding: 14px 36px;
  color: #dceeff;
  font-weight: 700;
  font-size: 1.1rem;
  cursor: pointer;
  box-shadow:
    0 0 25px #3388ffcc;
  user-select: none;
  transition: background-color 0.3s ease;
}

.settings-buttons button:hover {
  background: #44aaffee;
  box-shadow:
    0 0 36px #44aaffee;
}

.settings-buttons button:active {
  transform: scale(0.96);
}

/* === Animations for everything fancy === */
@keyframes glowPulse {
  0%, 100% {
    text-shadow:
      0 0 12px #33aaffaa,
      0 0 24px #55bbffcc;
  }
  50% {
    text-shadow:
      0 0 22px #66ccffdd,
      0 0 44px #99ddffee;
  }
}

@keyframes glowMove {
  0%, 100% {
    box-shadow:
      0 0 15px #3399ffcc,
      inset 0 0 20px #44bbffcc;
  }
  50% {
    box-shadow:
      0 0 28px #66bbffcc,
      inset 0 0 36px #77ccffcc;
  }
}

/* Responsive tweaks */
@media (max-width: 820px) {
  .page {
    grid-template-columns: 1fr;
    grid-template-rows: 64px 1fr 44px;
    grid-template-areas:
      "header"
      "main"
      "footer";
    border-radius: 0;
  }
  .sidebar {
    display: none;
  }
  .header-left h2 {
    font-size: 1.3rem;
  }
  .main {
    padding: 16px 20px;
  }
}

</style>
</head>
<body>
<div class="page" role="application" aria-label="GlizzyBot AI chat interface">
  <nav class="sidebar" aria-label="Primary navigation">
    <div class="sidebar-header">
      <img class="logo-img" src="https://i.imgur.com/J2bRVPq.png" alt="GlizzyBot Logo" />
      <h1 class="logo-text">GenBot</h1>
    </div>
    <div class="nav-tabs" role="tablist" aria-orientation="vertical">
      <button class="nav-tab active" id="tab-chat" role="tab" aria-selected="true" aria-controls="tabpanel-chat" tabindex="0">Chat</button>
      <button class="nav-tab" id="tab-contact" role="tab" aria-selected="false" aria-controls="tabpanel-contact" tabindex="-1">Contact</button>
      <button class="nav-tab" id="tab-premium" role="tab" aria-selected="false" aria-controls="tabpanel-premium" tabindex="-1">Premium</button>
      <button class="nav-tab" id="tab-settings" role="tab" aria-selected="false" aria-controls="tabpanel-settings" tabindex="-1">Settings</button>
    </div>
    <div class="sidebar-footer">Made with ✨ and neon glow by GenCodingAI</div>
  </nav>

  <header class="header">
    <div class="header-left">
      <h2 id="current-tab-title">Chat</h2>
    </div>
    <div class="header-right">
      <div id="googleSignInDiv" aria-label="Google sign-in button"></div>
      <button id="btnLogout" class="btn" hidden aria-label="Log out from Google">Logout</button>
    </div>
  </header>

  <main class="main">
    <!-- CHAT TAB -->
    <section id="tabpanel-chat" class="tab-content active" role="tabpanel" aria-labelledby="tab-chat" tabindex="0">
      <div class="chat-container">
        <div class="chat-header" aria-live="polite" aria-atomic="true">Free Coding AI</div>
        <div class="messages" id="chatMessages" aria-live="polite" aria-relevant="additions"></div>
        <div class="chat-input-container">
          <textarea id="chatInput" placeholder="Type your question and press Enter..." aria-label="Chat input"></textarea>
          <button id="btnSend" class="btn-send" aria-label="Send chat message">Send</button>
        </div>
      </div>
    </section>

    <!-- CONTACT TAB -->
    <section id="tabpanel-contact" class="tab-content" role="tabpanel" aria-labelledby="tab-contact" tabindex="0">
      <div class="contact-container">
        <h3>Contact GenBot Team</h3>
        <form id="contactForm" class="contact-form" novalidate>
          <label for="contactName">Name</label>
          <input type="text" id="contactName" name="contactName" placeholder="Your full name" required minlength="2" maxlength="100" />
          
          <label for="contactEmail">Email</label>
          <input type="email" id="contactEmail" name="contactEmail" placeholder="your.email@example.com" required />
          
          <label for="contactMessage">Message</label>
          <textarea id="contactMessage" name="contactMessage" placeholder="Write your message here" rows="6" required minlength="10"></textarea>
          
          <button type="submit" class="btn">Send Message</button>
        </form>
      </div>
    </section>

    <!-- PREMIUM TAB -->
    <section id="tabpanel-premium" class="tab-content" role="tabpanel" aria-labelledby="tab-premium" tabindex="0">
      <div class="premium-container" aria-label="Premium subscription plans">
        <h3>Unlock Premium Features</h3>
        <div class="premium-cards">
          <article class="premium-card" tabindex="0" aria-describedby="basic-desc">
            <h4>Basic Plan</h4>
            <ul id="basic-desc">
              <li>Unlimited chats per day</li>
              <li>Save chat history locally</li>
              <li>Basic priority support</li>
            </ul>
          </article>
          <article class="premium-card" tabindex="0" aria-describedby="pro-desc">
            <h4>Pro Plan</h4>
            <ul id="pro-desc">
              <li>All Basic features</li>
              <li>Cloud chat backup</li>
              <li>Custom bot personalities</li>
              <li>Faster response times</li>
            </ul>
          </article>
          <article class="premium-card" tabindex="0" aria-describedby="elite-desc">
            <h4>Elite Plan</h4>
            <ul id="elite-desc">
              <li>All Pro features</li>
              <li>Dedicated AI support</li>
              <li>Early access to new features</li>
              <li>VIP-only community</li>
            </ul>
          </article>
        </div>
      </div>
    </section>

    <!-- SETTINGS TAB -->
    <section id="tabpanel-settings" class="tab-content" role="tabpanel" aria-labelledby="tab-settings" tabindex="0">
      <div class="settings-container" role="form" aria-label="User settings">
        <h3>Settings</h3>
        <div class="settings-group">
          <label for="settingAutoSave">
            <input type="checkbox" id="settingAutoSave" />
            Automatically save chat history
          </label>
          <label for="settingAnimations">
            <input type="checkbox" id="settingAnimations" checked disabled />
            Message animations (always on)
          </label>
          <label for="settingDarkMode">
            <input type="checkbox" id="settingDarkMode" />
            Enable Dark Mode
          </label>
        </div>
        <div class="settings-buttons">
          <button id="btnExport" class="btn" aria-label="Export chat history">Export Chat History</button>
          <button id="btnClear" class="btn" aria-label="Clear chat history">Clear Chat History</button>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer" role="contentinfo">
    GenBot © 2025 — Crafted with futuristic vibes by GenBotAI
  </footer>
</div>
<script>
(() => {
  'use strict';

  // --- DOM references ---
  const tabs = document.querySelectorAll('.nav-tab');
  const tabContents = document.querySelectorAll('.tab-content');
  const currentTabTitle = document.getElementById('current-tab-title');

  // Chat elements
  const chatMessages = document.getElementById('chatMessages');
  const chatInput = document.getElementById('chatInput');
  const btnSend = document.getElementById('btnSend');

  // Contact form
  const contactForm = document.getElementById('contactForm');

  // Settings controls
  const settingAutoSave = document.getElementById('settingAutoSave');
  const settingAnimations = document.getElementById('settingAnimations');
  const settingDarkMode = document.getElementById('settingDarkMode');
  const btnExport = document.getElementById('btnExport');
  const btnClear = document.getElementById('btnClear');

  // Google sign in controls
  const googleSignInDiv = document.getElementById('googleSignInDiv');
  const btnLogout = document.getElementById('btnLogout');

  // --- State ---
  let googleUser = null;
  let chatHistory = [];
  let autoSaveEnabled = false;
  let animationsEnabled = true; // always true, disabled checkbox
  let darkModeEnabled = false;

  // --- Utility functions ---

  // Save chat history in localStorage keyed by userId
  function saveChatHistory() {
    if (!autoSaveEnabled || !googleUser) return;
    localStorage.setItem('glizzybot_history_' + googleUser.sub, JSON.stringify(chatHistory));
  }

  // Load chat history from localStorage
  function loadChatHistory() {
    if (!googleUser) return;
    const data = localStorage.getItem('GenBot_history_' + googleUser.sub);
    if (data) {
      try {
        chatHistory = JSON.parse(data);
      } catch {
        chatHistory = [];
      }
    } else {
      chatHistory = [];
    }
  }

  // Clear chat messages UI
  function clearMessages() {
    chatMessages.innerHTML = '';
  }

  // Append a message to chat UI with animation if enabled
  function addMessage(text, fromBot = false) {
    const msgDiv = document.createElement('div');
    msgDiv.classList.add('message');
    msgDiv.classList.add(fromBot ? 'bot' : 'user');
    msgDiv.textContent = text;
    if (animationsEnabled) {
      msgDiv.style.opacity = 0;
      msgDiv.style.transform = 'translateY(20px)';
      chatMessages.appendChild(msgDiv);
      // Trigger animation with delay
      requestAnimationFrame(() => {
        msgDiv.style.transition = 'opacity 0.45s ease, transform 0.45s ease';
        msgDiv.style.opacity = '1';
        msgDiv.style.transform = 'translateY(0)';
      });
    } else {
      chatMessages.appendChild(msgDiv);
    }
    chatMessages.scrollTop = chatMessages.scrollHeight;
  }

  // Append messages from history to UI
  function loadMessagesFromHistory() {
    clearMessages();
    for (const msg of chatHistory) {
      addMessage(msg.text, msg.fromBot);
    }
  }

  // Switch active tab UI & update aria attributes
  function switchTab(tabId) {
    tabs.forEach(t => {
      const active = t.id === tabId;
      t.classList.toggle('active', active);
      t.setAttribute('aria-selected', active ? 'true' : 'false');
      t.tabIndex = active ? 0 : -1;
    });
    tabContents.forEach(tc => {
      tc.classList.toggle('active', tc.id === 'tabpanel-' + tabId.slice(4));
      if (tc.id === 'tabpanel-' + tabId.slice(4)) tc.focus();
    });
    currentTabTitle.textContent = tabId.slice(4).charAt(0).toUpperCase() + tabId.slice(5);
  }

  // Validate contact form fields, returns true if valid, else false and marks invalid fields
  function validateContactForm() {
    let valid = true;
    const nameInput = contactForm.contactName;
    const emailInput = contactForm.contactEmail;
    const messageInput = contactForm.contactMessage;

    // Clear previous errors
    [nameInput, emailInput, messageInput].forEach(i => {
      i.style.borderColor = '';
      i.setAttribute('aria-invalid', 'false');
    });

    if (nameInput.value.trim().length < 2) {
      valid = false;
      nameInput.style.borderColor = '#ff5555';
      nameInput.setAttribute('aria-invalid', 'true');
    }

    const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailPattern.test(emailInput.value.trim())) {
      valid = false;
      emailInput.style.borderColor = '#ff5555';
      emailInput.setAttribute('aria-invalid', 'true');
    }

    if (messageInput.value.trim().length < 10) {
      valid = false;
      messageInput.style.borderColor = '#ff5555';
      messageInput.setAttribute('aria-invalid', 'true');
    }

    return valid;
  }

  // Handle contact form submit (dummy, no actual email sending)
  contactForm.addEventListener('submit', e => {
    e.preventDefault();
    if (!validateContactForm()) {
      alert('Please fill out the form correctly.');
      return;
    }
    alert('Thanks for contacting GenBot! We will get back to you soon.');
    contactForm.reset();
  });

  // --- Chat message sending ---

  async function sendMessage() {
    const question = chatInput.value.trim();
    if (!question) return;

    addMessage(question, false);
    chatHistory.push({ text: question, fromBot: false });
    chatInput.value = '';
    chatInput.disabled = true;
    btnSend.disabled = true;

    try {
      // Replace with your backend URL or OpenAI API proxy
      const response = await fetch('/chat', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ prompt: question }),
      });
      if (!response.ok) throw new Error('Network error');

      const data = await response.json();
      if (data.error) {
        addMessage('Error: ' + data.error, true);
        chatHistory.push({ text: 'Error: ' + data.error, fromBot: true });
      } else {
        addMessage(data.response, true);
        chatHistory.push({ text: data.response, fromBot: true });
      }
    } catch (err) {
      addMessage('Failed to connect to the server.', true);
      chatHistory.push({ text: 'Failed to connect to the server.', fromBot: true });
    }

    chatInput.disabled = false;
    btnSend.disabled = false;
    saveChatHistory();
  }

  btnSend.addEventListener('click', sendMessage);
  chatInput.addEventListener('keydown', e => {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      sendMessage();
    }
  });

  // --- Tabs switching ---
  tabs.forEach(tab => {
    tab.addEventListener('click', () => switchTab(tab.id));
    tab.addEventListener('keydown', e => {
      if (e.key === 'ArrowDown' || e.key === 'ArrowRight') {
        e.preventDefault();
        let next = tab.nextElementSibling || tabs[0];
        next.focus();
      } else if (e.key === 'ArrowUp' || e.key === 'ArrowLeft') {
        e.preventDefault();
        let prev = tab.previousElementSibling || tabs[tabs.length - 1];
        prev.focus();
      }
    });
  });

  // --- Settings controls ---

  settingAutoSave.addEventListener('change', e => {
    autoSaveEnabled = e.target.checked;
    if (autoSaveEnabled) saveChatHistory();
  });

  settingDarkMode.addEventListener('change', e => {
    darkModeEnabled = e.target.checked;
    document.body.classList.toggle('dark-mode', darkModeEnabled);
  });

  btnExport.addEventListener('click', () => {
    if (chatHistory.length === 0) return alert('No chat history to export.');
    let exportText = chatHistory
      .map(msg => (msg.fromBot ? 'GenBot: ' : 'You: ') + msg.text)
      .join('\n');
    const blob = new Blob([exportText], { type: 'text/plain' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'GenBot_chat_history.txt';
    a.click();
    URL.revokeObjectURL(url);
  });

  btnClear.addEventListener('click', () => {
    if (!confirm('Clear chat history? This cannot be undone.')) return;
    chatHistory = [];
    clearMessages();
    if (googleUser) localStorage.removeItem('GenBot_history_' + googleUser.sub);
  });

  // --- Google Sign-In handling ---

  function showLoggedInUI() {
    googleSignInDiv.style.display = 'none';
    btnLogout.hidden = false;
    settingAutoSave.disabled = false;
    loadChatHistory();
    loadMessagesFromHistory();
  }

  function showLoggedOutUI() {
    googleSignInDiv.style.display = 'block';
    btnLogout.hidden = true;
    settingAutoSave.disabled = true;
    chatHistory = [];
    clearMessages();
  }

  function handleCredentialResponse(response) {
    if (!response.credential) return;
    try {
      const user = jwt_decode(response.credential);
      googleUser = user;
      showLoggedInUI();
    } catch (e) {
      console.error('Google credential decode error:', e);
    }
  }

  window.onload = () => {
    // Initialize Google Sign-In button
    google.accounts.id.initialize({
      client_id: '472534217982-bjn2mbaq2t1f1s8jenqh6t389u595kcf.apps.googleusercontent.com',
      callback: handleCredentialResponse,
      auto_select: false,
      cancel_on_tap_outside: true,
    });
    google.accounts.id.renderButton(
      googleSignInDiv,
      { theme: 'outline', size: 'medium', width: 180 }
    );
    google.accounts.id.prompt();

    // Start with Chat tab
    switchTab('tab-chat');
  };

  btnLogout.addEventListener('click', () => {
    google.accounts.id.disableAutoSelect();
    googleUser = null;
    showLoggedOutUI();
  });

  // --- Dark mode CSS toggle ---
  const darkModeStyles = `
    body.dark-mode {
      background: linear-gradient(135deg, #000814, #001022);
      color: #a0c8ffdd;
    }
    body.dark-mode .page {
      background: #000a1e;
      box-shadow:
        0 0 40px #0033ffcc inset;
    }
    body.dark-mode .sidebar {
      background: #000a1f;
      border-color: #0055ffcc;
      box-shadow: inset -3px 0 20px #0066ff66;
    }
    body.dark-mode .nav-tab.active {
      background: #0077ffcc;
      border-color: #99ccffdd;
      box-shadow: 0 0 40px #55bbffdd inset;
    }
    body.dark-mode .header {
      background: #000e2e;
      border-color: #0055ffcc;
      box-shadow: 0 2px 22px #0044ffcc inset;
    }
    body.dark-mode .footer {
      background: #000d24;
      border-color: #0044ffcc;
      box-shadow: inset 0 1px 10px #0033ccdd;
    }
    body.dark-mode .messages {
      background: #001533;
      color: #a4c8ffdd;
      box-shadow: inset 0 0 22px #0055ffcc;
    }
    body.dark-mode .message.bot {
      background: linear-gradient(135deg, #003366, #004d99);
      color: #bbdfffcc;
      box-shadow: 0 0 22px #3399ffdd inset;
    }
    body.dark-mode .message.user {
      background: linear-gradient(135deg, #004dbb, #3366ff);
      color: #d1e7ffcc;
      box-shadow: 0 0 24px #55aaffcc inset;
    }
    body.dark-mode #chatInput {
      background: #002050;
      color: #bbdfffcc;
      box-shadow: inset 0 0 18px #0055ffcc;
    }
    body.dark-mode .btn-send {
      background: linear-gradient(135deg, #3366ff, #2244cc);
      box-shadow: 0 0 36px #4477ffcc;
    }
    body.dark-mode .btn-send:hover {
      background: linear-gradient(135deg, #5599ff, #3366ff);
      box-shadow: 0 0 48px #66bbffdd;
    }
  `;

  // Inject dark mode styles on toggle
  const styleSheet = document.createElement('style');
  styleSheet.textContent = darkModeStyles;
  document.head.appendChild(styleSheet);

})();
</script>
</body>
</html>
>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GenCoding - The Best AI Computer Programming Experience</title>
  <meta name="google-site-verification" content="wnmHz1u7I5ExKiKCmM_K6EgDmRfAqzmIWWrf0TCvdB0" />
</head>
